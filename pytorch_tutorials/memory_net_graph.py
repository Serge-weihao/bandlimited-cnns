from pytorch_tutorials.memory_net import plot_figure

# ,batch_sizes=[2]
# ,batch_forward_times=[[0.00056183,,0.00040889,,0.00051284,,0.00051737,,0.00054479,,0.00056517,
# ,,0.00058627]]
# ,batch_backward_times=[[0.00065327,,0.00047159,0.00062776,0.00051415,0.00050056,0.00057197
# ,,0.00058806]]
# ,batch_input_sizes=[[,16,,32,,64,128,256,512,1024]]

# batch_sizes = [1]
# batch_forward_times = [[0.0004108, 0.00041997, 0.00052273, 0.0005244, 0.00053132, 0.00064421, 0.0005697, ]]
# batch_backward_times = [[0.0004822, 0.00048172, 0.00063741, 0.00050569, 0.00051069, 0.00057614, 0.00059187]]
# batch_input_sizes = [[16, 32, 64, 128, 256, 512, 1024]]

# batch_sizes= [64]
# batch_input_sizes= [[16, 32, 64, 128, 256, 512]]
# batch_forward_times= [[0.0004315376281738281, 0.00041675567626953125, 0.0005283355712890625, 0.0005514621734619141, 0.000568389892578125, 0.0005728006362915039]]
# batch_backward_times= [[0.00048410892486572266, 0.0004807710647583008, 0.0005575418472290039, 0.0005686283111572266, 0.0005768537521362305, 0.0005848407745361328]]
# batch_optimizer_times= [[0.00022029876708984375, 0.00022733211517333984, 0.00023317337036132812, 0.00024390220642089844, 0.00024449825286865234, 0.0002460479736328125]]

batch_sizes= [8, 16, 32, 64]
batch_input_sizes= [[64, 128, 256, 512], [64, 128, 256, 512], [64, 128, 256, 512], [64, 128, 256, 512]]
batch_forward_times= [[0.0012279748916625977, 0.0010262727737426758, 0.0010416507720947266, 0.001077890396118164], [0.0010633468627929688, 0.0009784698486328125, 0.0011539459228515625, 0.001075148582458496], [0.0010313987731933594, 0.0010514259338378906, 0.0011680126190185547, 0.0012078285217285156], [0.0009953975677490234, 0.0011023283004760742, 0.0011980533599853516, 0.0012406110763549805]]
batch_backward_times= [[0.0009067058563232422, 0.0008111000061035156, 0.0008884668350219727, 0.0009120702743530273], [0.0008194446563720703, 0.0008450746536254883, 0.0009732246398925781, 0.0010466575622558594], [0.00081634521484375, 0.0009436607360839844, 0.0009729862213134766, 0.0010210275650024414], [0.0008831024169921875, 0.0010066032409667969, 0.0010194778442382812, 0.0011824369430541992]]
batch_optimizer_times= [[0.0003604888916015625, 0.0003342628479003906, 0.00035250186920166016, 0.0003504753112792969], [0.0003349781036376953, 0.00034058094024658203, 0.0003552436828613281, 0.00036263465881347656], [0.00033605098724365234, 0.0003541707992553711, 0.00035369396209716797, 0.00036215782165527344], [0.00034737586975097656, 0.0003533363342285156, 0.00035560131072998047, 0.000362396240234375]]


batch_sizes= [8, 16, 32, 64]
batch_input_sizes= [[64, 128, 256, 512], [64, 128, 256, 512], [64, 128, 256, 512], [64, 128, 256, 512]]
batch_forward_times= [[0.0005017518997192383, 0.0005060434341430664, 0.0005239248275756836, 0.0005753040313720703], [0.0005052089691162109, 0.0005195140838623047, 0.0005660057067871094, 0.0005799531936645508], [0.0005041360855102539, 0.0005156993865966797, 0.0005723237991333008, 0.0005772113800048828], [0.0005165338516235352, 0.0005384683609008789, 0.0005561113357543945, 0.0005483627319335938]]
batch_backward_times= [[0.0006178617477416992, 0.00048720836639404297, 0.0005409717559814453, 0.00057220458984375], [0.0004907846450805664, 0.00048720836639404297, 0.0005644559860229492, 0.0005720853805541992], [0.0005391836166381836, 0.0005418062210083008, 0.0005704164505004883, 0.0005731582641601562], [0.0005413293838500977, 0.0005629062652587891, 0.0005699396133422852, 0.0005756616592407227]]
batch_optimizer_times= [[0.00021636486053466797, 0.0002830028533935547, 0.0002315044403076172, 0.0002351999282836914], [0.00028514862060546875, 0.00022232532501220703, 0.0002357959747314453, 0.00023651123046875], [0.0002840757369995117, 0.00023257732391357422, 0.0002353191375732422, 0.00023555755615234375], [0.00022089481353759766, 0.00023555755615234375, 0.00023543834686279297, 0.0002351999282836914]]


plot_figure(batch_forward_times=batch_forward_times, batch_backward_times=batch_backward_times,
            batch_input_sizes=batch_input_sizes, batch_sizes=batch_sizes, iter_number_total=10)
